---
title: "Open Data from CBS using R"
subtitle: "cbsodataR: find and use public open statistics on NL" 
author: "Edwin de Jonge"
date: "Statistics Netherlands / NSC-R 2022"
output:
  beamer_presentation:
    includes:
      in_header: tex/header.tex
    keep_tex: yes
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval = TRUE)
```

## Who am I?

-   Data scientist / Methodologist at Statistics Netherlands (aka CBS).
-   Author of several R-packages, including `whisker`, `validate`,
    `errorlocate`, `docopt`, `daff`, `chunked` , *`cbsodataR`*...
-   Co-author of *Statistical Data Cleaning with applications in
    R (2018)* (together with @markvdloo)
-   background in theoretical/comptutional physics, now since long a
    "statistician".

## Daily work:

-   expertise: Statistical Computing, (incl R and Python), Network
    analysis, Data Visualisation.
-   Complexity Science Research / Population and Enterprise networks.
-   Internal statistical consultant

## CBS

-   Centraal Bureau voor de Statistiek = Statistics Netherlands

-   Founded in 1899

-   Governmental Agency ("ZBO" under EZK)

-   publishes official statistics on various topics:

    -   demographics
    -   economy, GDP (economic growth),
    -   education
    -   agriculture
    -   environment
    -   Sustainable Development Goals (sdg)
    -   **crime**

## CBS open data?

### StatLine, CBS (Statistics Netherlands)

-   Since 1995, Statistics Netherlands has StatLine, output database:
    all (tabular) data produced by CBS.

-   search, select, view and download data

-   statline: open data *avant la lettre* : <https://opendata.cbs.nl>

## What is open data?

Open as in: - free to download and use (with referencing)

But also: - "machine readable" - should be possible to retrieve data and
meta data "automagically". - implemented with a Web API. (application
programming interface)

## CBS open data:

-   implements *odata3* web api for all StatLine tables (>3500) and
    their metadata.
-   allows for retrieving data at any time.

### What is `cbsodataR`?

-   R wrapper for Web API to facilitate downloading data.
-   Adds metadata easily
-   Allows for finding and searching data
-   Allows for filtering data.

Is used by:

-   government agencies: e.g. CPB, SCP, RIVM, etc.
-   data journalists

## cbsodataR Functionality

-   Retrieve a list of datasets
-   Find a specific data set
-   Download data
-   Add metadata
-   Filter data

## `cbs_get_datasets()`

-   retrieve a list of all open data tables + their publication meta
    data \tiny

```{r}
library(cbsodataR)
ds <- cbs_get_datasets() 
ds[1:4, 1:3]
```

## `cbs_search`

-   retrieve a list of data table containing search words

\small

```{r}
theft <- cbs_search("diefstal")
theft[1:4, 2:4]
```

## `cbs_get_meta()`

-   Use `Identifier` to retrieve metadata of a table
-   contains all metadata (including borders of table).
-   Each property is a data.frame containing metadata e.g.

```{r}
m <- cbs_get_meta("83648NED") # geregistreerde criminaliteit
names(m)
m$SoortMisdrijf[1:5, 1:2]
```

## `cbs_get_data`

-   retrieve data using an Identifier
-   returns a `data.frame` with metadata "embedded"

```{r}
d <- cbs_get_data("83648NED", Perioden="2021JJ00")
```

## intermezzo: Web API

\tiny

```{r}
d <- cbs_get_data("83648NED", Perioden="2021JJ00", verbose=TRUE)
```

## Live demo

## Toekomst:

-   Nieuwere versie van de Web API OData4 (nog in beta / test versie)

# volgende versie van

-   <https://statistiekcbs.github.io/cbsodata4>

Thank you for your attention!
